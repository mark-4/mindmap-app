# マインドマップアプリ

PySide6を使用したデスクトップマインドマップアプリケーションです。

## 機能

### 基本機能
- **ノード作成・編集**: ノードの追加、削除、テキスト編集
- **接続線**: ノード間の接続（クランク状の3段階接続線）
- **ドラッグ&ドロップ**: ノードの自由な移動
- **Undo/Redo**: 操作の取り消し・再実行（Cmd+Z/Cmd+Shift+Z）

### レイアウト機能
- **スマート配置**: ノードの自動配置と衝突回避
- **階層レイアウト**: 親子関係に基づく自動レイアウト
- **接続線交差回避**: 接続線同士の交差を自動解決
- **グリッド表示・スナップ**: グリッド表示とノードのグリッドスナップ

### カスタマイズ機能
- **透明度調整**: 背景、ノード、接続線の個別透明度設定
- **ズーム速度調整**: マウスホイールズームの速度調整
- **ノード形状**: 矩形ノード（選択時は枠線強調）

### データ管理
- **JSON保存・読み込み**: マインドマップの保存・復元
- **キーボードショートカット**: 各種操作のショートカット

## インストール

### 必要な環境
- Python 3.11以上
- PySide6

### セットアップ
```bash
# リポジトリをクローン
git clone <repository-url>
cd maps

# 仮想環境を作成・有効化
python -m venv .venv
source .venv/bin/activate  # macOS/Linux
# .venv\Scripts\activate  # Windows

# 依存関係をインストール
pip install PySide6

# アプリケーションを実行
python main.py
```

## 使用方法

### 基本操作
1. **ノード追加**: Tabキーまたは「ノード追加」ボタン
2. **ノード接続**: Shiftキーを押しながら2つのノードをクリック
3. **ノード移動**: ノードをドラッグ
4. **ノード削除**: ノードを選択してDeleteキー
5. **テキスト編集**: ノードをダブルクリック

### キーボードショートカット
- `Tab`: ノード追加
- `Delete/Backspace`: 選択ノード削除
- `Cmd+Z`: Undo
- `Cmd+Shift+Z`: Redo
- `Cmd+S`: 保存
- `Cmd+O`: 読み込み
- `Escape`: 接続モードキャンセル
- `矢印キー`: ノード選択移動

### ツールバー機能
- **Undo/Redo**: 操作の取り消し・再実行
- **ノード追加**: 新しいノードを作成
- **接続モード**: ノード接続モードの切り替え
- **フィット**: 全ノードを画面に収める
- **ズーム速度**: ズーム速度の調整
- **透明度**: 各要素の透明度設定
- **グリッド**: グリッド表示の切り替え
- **グリッドスナップ**: グリッドスナップの切り替え
- **交差解決**: 接続線の交差を手動解決
- **削除**: 選択ノードの削除
- **保存/読み込み**: ファイル操作

## 技術仕様

### アーキテクチャ
- **フレームワーク**: PySide6 (Qt6)
- **言語**: Python 3.11+
- **アーキテクチャ**: MVCパターン

### 主要クラス
- `MainWindow`: メインウィンドウとツールバー管理
- `MindMapView`: グラフィックスビューとイベント処理
- `NodeItem`: ノードアイテム（矩形、テキスト、接続管理）
- `CrankConnection`: 3段階クランク状接続線
- `QUndoCommand`サブクラス: Undo/Redo機能

### アルゴリズム
- **衝突検出**: 矩形ベースの衝突判定
- **接続線交差検出**: CCWアルゴリズム
- **階層レイアウト**: 親子関係に基づく自動配置
- **スマート配置**: 衝突回避と最適配置

## 開発

### コード品質
- **リンター**: Ruff + Black
- **Pre-commit**: 自動コードフォーマット

### 実行
```bash
# 開発モードで実行
python main.py

# リンター実行
ruff check .
black .

# Pre-commit実行
pre-commit run --all-files
```

## ライセンス

MIT License

## 貢献

プルリクエストやイシューの報告を歓迎します。

## 更新履歴

### v1.0.0
- 基本的なマインドマップ機能
- ノード作成・編集・削除
- 接続線機能
- Undo/Redo機能
- JSON保存・読み込み
- 透明度調整
- グリッド機能
- 接続線交差回避
- キーボードナビゲーション
